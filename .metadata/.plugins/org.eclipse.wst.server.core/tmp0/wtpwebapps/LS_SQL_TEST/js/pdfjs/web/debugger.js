"use strict";var FontInspector=function(){function s(){var e=document.querySelectorAll("div["+i+"]");for(var t=0,n=e.length;t<n;++t){var r=e[t];r.className=""}}function o(){var e=document.querySelectorAll("div["+i+"]");for(var t=0,n=e.length;t<n;++t){var r=e[t];r.className="debuggerHideText"}}function u(e,t){var n=document.querySelectorAll("div["+i+"="+e+"]");for(var r=0,s=n.length;r<s;++r){var o=n[r];o.className=t?"debuggerShowText":"debuggerHideText"}}function a(e){if(!e.target.dataset.fontName||e.target.tagName.toUpperCase()!=="DIV"){return}var t=e.target.dataset.fontName;var n=document.getElementsByTagName("input");for(var r=0;r<n.length;++r){var i=n[r];if(i.dataset.fontName!=t){continue}i.checked=!i.checked;u(t,i.checked);i.scrollIntoView()}}var t;var n=300;var r=false;var i="data-font-name";return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(){var n=this.panel;n.setAttribute("style","padding: 5px;");var r=document.createElement("button");r.addEventListener("click",o);r.textContent="Refresh";n.appendChild(r);t=document.createElement("div");n.appendChild(t)},cleanup:function(){t.textContent=""},enabled:false,get active(){return r},set active(e){r=e;if(r){document.body.addEventListener("click",a,true);o()}else{document.body.removeEventListener("click",a,true);s()}},fontAdded:function(n,r){function i(e,t){var n=document.createElement("table");for(var r=0;r<t.length;r++){var i=document.createElement("tr");var s=document.createElement("td");s.textContent=t[r];i.appendChild(s);var o=document.createElement("td");o.textContent=e[t[r]].toString();i.appendChild(o);n.appendChild(i)}return n}var s=i(n,["name","type"]);var a=/url\(['"]?([^\)"']+)/.exec(r);var f=n.loadedName;var l=document.createElement("div");var c=document.createElement("span");c.textContent=f;var h=document.createElement("a");h.href=a[1];h.textContent="Download";var p=document.createElement("a");p.href="";p.textContent="Log";p.addEventListener("click",function(e){e.preventDefault();console.log(n)});var d=document.createElement("input");d.setAttribute("type","checkbox");d.dataset.fontName=f;d.addEventListener("click",function(e,t){return function(){u(t,e.checked)}}(d,f));l.appendChild(d);l.appendChild(c);l.appendChild(document.createTextNode(" "));l.appendChild(h);l.appendChild(document.createTextNode(" "));l.appendChild(p);l.appendChild(s);t.appendChild(l);setTimeout(function(){if(this.active){o()}}.bind(this),2e3)}}}();var StepperManager=function(){var t=[];var n=null;var r=null;var i=null;var s={};return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(){var t=this;this.panel.setAttribute("style","padding: 5px;");r=document.createElement("div");i=document.createElement("select");i.addEventListener("change",function(e){t.selectStepper(this.value)});r.appendChild(i);n=document.createElement("div");this.panel.appendChild(r);this.panel.appendChild(n);if(sessionStorage.getItem("pdfjsBreakPoints")){s=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))}},cleanup:function(){i.textContent="";n.textContent="";t=[]},enabled:false,active:false,create:function(r){var o=document.createElement("div");o.id="stepper"+r;o.setAttribute("hidden",true);o.className="stepper";n.appendChild(o);var u=document.createElement("option");u.textContent="Page "+(r+1);u.value=r;i.appendChild(u);var a=s[r]||[];var f=new Stepper(o,r,a);t.push(f);if(t.length===1){this.selectStepper(r,false)}return f},selectStepper:function(n,r){if(r){this.manager.selectPanel(this)}for(var s=0;s<t.length;++s){var o=t[s];if(o.pageIndex==n){o.panel.removeAttribute("hidden")}else{o.panel.setAttribute("hidden",true)}}var u=i.options;for(var s=0;s<u.length;++s){var a=u[s];a.selected=a.value==n}},saveBreakPoints:function(t,n){s[t]=n;sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(s))}}}();var Stepper=function(){function t(e,t){var n=document.createElement(e);if(t){n.textContent=t}return n}function n(e){var t="";for(var n=0;n<e.length;n++){if(e[n]===null){t+=" "}else{t+=e[n].fontChar}}return t}function s(e){if(typeof e==="string"){var t=75;return e.length<=t?e:e.substr(0,t)+"..."}if(typeof e!=="object"||e===null){return e}if("length"in e){var n=[],r,i;var o=10;for(r=0,i=Math.min(o,e.length);r<i;r++){n.push(s(e[r]))}if(r<e.length){n.push("...")}return n}var u={};for(var a in e){u[a]=s(e[a])}return u}function o(e,t,n){this.panel=e;this.breakPoint=0;this.nextBreakPoint=null;this.pageIndex=t;this.breakPoints=n;this.currentIdx=-1;this.operatorListIdx=0}var r=null;var i={showText:0,showSpacedText:0,nextLineShowText:0,nextLineSetSpacingShowText:2};o.prototype={init:function(){var n=this.panel;var i=t("div","c=continue, s=step");var s=t("table");i.appendChild(s);s.cellSpacing=0;var o=t("tr");s.appendChild(o);o.appendChild(t("th","Break"));o.appendChild(t("th","Idx"));o.appendChild(t("th","fn"));o.appendChild(t("th","args"));n.appendChild(i);this.table=s;if(!r){r=Object.create(null);for(var u in PDFJS.OPS){r[PDFJS.OPS[u]]=u}}},updateOperatorList:function(o){function u(){var e=+this.dataset.idx;if(this.checked){f.breakPoints.push(e)}else{f.breakPoints.splice(f.breakPoints.indexOf(e),1)}StepperManager.saveBreakPoints(f.pageIndex,f.breakPoints)}var a=15e3;if(this.operatorListIdx>a){return}var f=this;var l=document.createDocumentFragment();var h=Math.min(a,o.fnArray.length);for(var p=this.operatorListIdx;p<h;p++){var d=t("tr");d.className="line";d.dataset.idx=p;l.appendChild(d);var v=this.breakPoints.indexOf(p)!=-1;var m=o.argsArray[p]||[];var g=t("td");var y=t("input");y.type="checkbox";y.className="points";y.checked=v;y.dataset.idx=p;y.onclick=u;g.appendChild(y);d.appendChild(g);d.appendChild(t("td",p.toString()));var b=r[o.fnArray[p]];var w=m;if(b in i){var E=i[b];var S=m[E];var w=m.slice();var x;if(b==="showSpacedText"){x=[];for(var T=0;T<S.length;T++){if(typeof S[T]==="number"){x.push(S[T])}else{x.push(n(S[T]))}}}else{x=n(S)}w[E]=x}d.appendChild(t("td",b));d.appendChild(t("td",JSON.stringify(s(w))))}if(h<o.fnArray.length){d=t("tr");var N=t("td","...");N.colspan=4;l.appendChild(N)}this.operatorListIdx=o.fnArray.length;this.table.appendChild(l)},getNextBreakPoint:function(){this.breakPoints.sort(function(e,t){return e-t});for(var t=0;t<this.breakPoints.length;t++){if(this.breakPoints[t]>this.currentIdx){return this.breakPoints[t]}}return null},breakIt:function(t,n){StepperManager.selectStepper(this.pageIndex,true);var r=this;var i=document;r.currentIdx=t;var s=function(e){switch(e.keyCode){case 83:i.removeEventListener("keydown",s,false);r.nextBreakPoint=r.currentIdx+1;r.goTo(-1);n();break;case 67:i.removeEventListener("keydown",s,false);var t=r.getNextBreakPoint();r.nextBreakPoint=t;r.goTo(-1);n();break}};i.addEventListener("keydown",s,false);r.goTo(t)},goTo:function(t){var n=this.panel.getElementsByClassName("line");for(var r=0,i=n.length;r<i;++r){var s=n[r];if(s.dataset.idx==t){s.style.backgroundColor="rgb(251,250,207)";s.scrollIntoView()}else{s.style.backgroundColor=null}}}};return o}();var Stats=function(){function n(e){while(e.hasChildNodes()){e.removeChild(e.lastChild)}}function r(e){for(var n=0,r=t.length;n<r;++n){if(t[n].pageNumber===e){return n}}return false}var t=[];return{id:"Stats",name:"Stats",panel:null,manager:null,init:function(){this.panel.setAttribute("style","padding: 5px;");PDFJS.enableStats=true},enabled:false,active:false,add:function(e,i){if(!i){return}var s=r(e);if(s!==false){var o=t[s];this.panel.removeChild(o.div);t.splice(s,1)}var u=document.createElement("div");u.className="stats";var a=document.createElement("div");a.className="title";a.textContent="Page: "+e;var f=document.createElement("div");f.textContent=i.toString();u.appendChild(a);u.appendChild(f);t.push({pageNumber:e,div:u});t.sort(function(e,t){return e.pageNumber-t.pageNumber});n(this.panel);for(var l=0,c=t.length;l<c;++l){this.panel.appendChild(t[l].div)}},cleanup:function(){t=[];n(this.panel)}}}();var PDFBug=function(){var t=300;var n=[];var r=null;return{tools:[FontInspector,StepperManager,Stats],enable:function(e){var t=false,n=this.tools;if(e.length===1&&e[0]==="all"){t=true}for(var r=0;r<n.length;++r){var i=n[r];if(t||e.indexOf(i.id)!==-1){i.enabled=true}}if(!t){n.sort(function(t,r){var i=e.indexOf(t.id);i=i<0?n.length:i;var s=e.indexOf(r.id);s=s<0?n.length:s;return i-s})}},init:function(){var r=document.createElement("div");r.id="PDFBug";var i=document.createElement("div");i.setAttribute("class","controls");r.appendChild(i);var s=document.createElement("div");s.setAttribute("class","panels");r.appendChild(s);var o=document.getElementById("viewerContainer");o.appendChild(r);o.style.right=t+"px";var u=this.tools;var a=this;for(var f=0;f<u.length;++f){var l=u[f];var c=document.createElement("div");var h=document.createElement("button");h.textContent=l.name;h.addEventListener("click",function(e){return function(t){t.preventDefault();a.selectPanel(e)}}(f));i.appendChild(h);s.appendChild(c);l.panel=c;l.manager=this;if(l.enabled){l.init()}else{c.textContent=l.name+" is disabled. To enable add "+' "'+l.id+'" to the pdfBug parameter '+"and refresh (seperate multiple by commas)."}n.push(h)}this.selectPanel(0)},cleanup:function(){for(var t=0,n=this.tools.length;t<n;t++){if(this.tools[t].enabled){this.tools[t].cleanup()}}},selectPanel:function(t){if(typeof t!=="number"){t=this.tools.indexOf(t)}if(t===r){return}r=t;var i=this.tools;for(var s=0;s<i.length;++s){if(s==t){n[s].setAttribute("class","active");i[s].active=true;i[s].panel.removeAttribute("hidden")}else{n[s].setAttribute("class","");i[s].active=false;i[s].panel.setAttribute("hidden","true")}}}}}()